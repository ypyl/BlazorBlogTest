@using Services

@inject ArticleService articleService

<MudNavMenu>
    <MudList DisablePadding="true" Dense="true" >
        <MudListSubheader>
            <MudTextField @bind-Value="@searchTerm" Immediate="true" Margin="Margin.Dense" Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.Search" />
        </MudListSubheader>

        @foreach (var articleName in ArticleNames())
        {
            <MudListItem @key="articleName" Class="pa-0 ma-0">
                <MudNavLink Href="@articleName" Match="NavLinkMatch.Prefix">
                    <MudHighlighter Text="@CleanArticleName(articleName)" HighlightedText="@searchTerm"/>
                </MudNavLink>
            </MudListItem>
        }
    </MudList>
</MudNavMenu>

@code {
    string searchTerm = "";

    public IEnumerable<string> ArticleNames()
    {
        return articleService.ArticleNames().Where(x => x.Contains(searchTerm, StringComparison.OrdinalIgnoreCase));
    }

    public string CleanArticleName(string articleName)
    {
        return string.Join(' ', articleName.Split("-").Skip(3));
    }
}
